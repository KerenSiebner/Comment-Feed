{"ast":null,"code":"var _jsxFileName = \"/Users/kerenzilberman/Library/Mobile Documents/com~apple~CloudDocs/dev/Keren Siebner Zilberman/Day 103- Prep Job Interview/Comments Feed/frontend/src/pages/comment-feed.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { socketService, SOCKET_EMIT_SEND_MSG, SOCKET_EVENT_ADD_MSG, SOCKET_EMIT_SET_TOPIC } from '../services/socket.service';\nimport { getActionAddMsg } from '../store/msg.actions';\nimport { store } from '../store/store';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport function CommentFeed() {\n  _s();\n  const [msg, setMsg] = useState({\n    txt: '',\n    email: ''\n  });\n  // const [msgs, setMsgs] = useState([])\n  const [filteredMsgs, setFilteredMsgs] = useState(msgs);\n  const [searchedTxt, setSearchedTxt] = useState('');\n  const msgs = useSelector(storeState);\n  const dispatch = useDispatch();\n  useEffect(() => {\n    socketService.on(SOCKET_EVENT_ADD_MSG, addMsg);\n    return () => {\n      socketService.off(SOCKET_EVENT_ADD_MSG, addMsg);\n    };\n  }, []);\n  function addMsg(newMsg) {\n    setMsgs(prevMsgs => [...prevMsgs, newMsg]);\n  }\n  function sendMsg(ev) {\n    ev.preventDefault();\n    const newMsg = {\n      email: msg.email,\n      txt: msg.txt\n    };\n    socketService.emit(SOCKET_EMIT_SEND_MSG, newMsg);\n    // for now - we add the msg ourself\n    addMsg(newMsg);\n    dispatch(getActionAddMsg(newMsg));\n    setMsg({\n      txt: '',\n      email: ''\n    });\n  }\n  function handleFormChange(ev) {\n    const {\n      name,\n      value\n    } = ev.target;\n    setMsg(prevMsg => ({\n      ...prevMsg,\n      [name]: value\n    }));\n  }\n  function setFilterBy(_ref) {\n    let {\n      target\n    } = _ref;\n    const {\n      value\n    } = target;\n    setSearchedTxt(value);\n    const regex = new RegExp(value, 'i');\n    const filteredMsgs = msgs === null || msgs === void 0 ? void 0 : msgs.filter(msg => regex.test(msg.txt));\n    console.log('filteredMsgs', filteredMsgs);\n    setMsgs(filteredMsgs);\n  }\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    className: \"chat-app\",\n    children: [/*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: sendMsg,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        name: \"email\",\n        value: msg.email,\n        placeholder: \"Email\",\n        onChange: handleFormChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        value: msg.txt,\n        onChange: handleFormChange,\n        name: \"txt\",\n        autoComplete: \"off\",\n        placeholder: \"Message\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        children: \"SUBMIT\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      value: searchedTxt,\n      placeholder: \"Filter\",\n      onChange: setFilterBy\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: msgs.map((msg, idx) => /*#__PURE__*/_jsxDEV(\"li\", {\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: `https://www.gravatar.com/avatar/205e460b479e2e5b48aec07710c08d50`,\n          style: {\n            width: '30px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 13\n        }, this), msg.email, \": \", msg.txt]\n      }, idx, true, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 5\n  }, this);\n}\n_s(CommentFeed, \"94J8JXCLuxPhIMTYGrKCqMD39cI=\", false, function () {\n  return [useSelector, useDispatch];\n});\n_c = CommentFeed;\nvar _c;\n$RefreshReg$(_c, \"CommentFeed\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useDispatch","useSelector","socketService","SOCKET_EMIT_SEND_MSG","SOCKET_EVENT_ADD_MSG","SOCKET_EMIT_SET_TOPIC","getActionAddMsg","store","CommentFeed","msg","setMsg","txt","email","filteredMsgs","setFilteredMsgs","msgs","searchedTxt","setSearchedTxt","storeState","dispatch","on","addMsg","off","newMsg","setMsgs","prevMsgs","sendMsg","ev","preventDefault","emit","handleFormChange","name","value","target","prevMsg","setFilterBy","regex","RegExp","filter","test","console","log","map","idx","width"],"sources":["/Users/kerenzilberman/Library/Mobile Documents/com~apple~CloudDocs/dev/Keren Siebner Zilberman/Day 103- Prep Job Interview/Comments Feed/frontend/src/pages/comment-feed.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\n\r\nimport { socketService, SOCKET_EMIT_SEND_MSG, SOCKET_EVENT_ADD_MSG, SOCKET_EMIT_SET_TOPIC } from '../services/socket.service'\r\nimport { getActionAddMsg } from '../store/msg.actions'\r\nimport { store } from '../store/store'\r\n\r\nexport function CommentFeed() {\r\n  const [msg, setMsg] = useState({ txt: '', email: '' })\r\n  // const [msgs, setMsgs] = useState([])\r\n  const [filteredMsgs, setFilteredMsgs] = useState(msgs)\r\n  const [searchedTxt, setSearchedTxt] = useState('')\r\n\r\n  const msgs = useSelector(storeState)\r\n\r\n  const dispatch = useDispatch()\r\n\r\n  useEffect(() => {\r\n    socketService.on(SOCKET_EVENT_ADD_MSG, addMsg)\r\n    return () => {\r\n    socketService.off(SOCKET_EVENT_ADD_MSG, addMsg)\r\n    }\r\n  }, [])\r\n\r\n  function addMsg(newMsg) {\r\n    setMsgs(prevMsgs => [...prevMsgs, newMsg])\r\n  }\r\n\r\n  function sendMsg(ev) {\r\n    ev.preventDefault()\r\n    const newMsg = { email: msg.email, txt: msg.txt }\r\n    socketService.emit(SOCKET_EMIT_SEND_MSG, newMsg)\r\n    // for now - we add the msg ourself\r\n    addMsg(newMsg)\r\n    dispatch(getActionAddMsg(newMsg))\r\n    setMsg({ txt: '', email: '' })\r\n  }\r\n\r\n  function handleFormChange(ev) {\r\n    const { name, value } = ev.target\r\n    setMsg(prevMsg => ({ ...prevMsg, [name]: value }))\r\n  }\r\n\r\n  function setFilterBy({ target }) {\r\n    const { value } = target\r\n    setSearchedTxt(value)\r\n    const regex = new RegExp(value, 'i')\r\n    const filteredMsgs = msgs?.filter(msg=> regex.test(msg.txt))\r\n    console.log('filteredMsgs', filteredMsgs)\r\n    setMsgs(filteredMsgs)\r\n  }\r\n\r\n  return (\r\n    <section className=\"chat-app\">\r\n      <form onSubmit={sendMsg}>\r\n        <input\r\n          type=\"text\"\r\n          name=\"email\"\r\n          value={msg.email}\r\n          placeholder=\"Email\"\r\n          onChange={handleFormChange} />\r\n        <input\r\n          type=\"text\"\r\n          value={msg.txt}\r\n          onChange={handleFormChange}\r\n          name=\"txt\"\r\n          autoComplete=\"off\"\r\n          placeholder='Message' />\r\n        <button>SUBMIT</button>\r\n      </form>\r\n      <input type=\"text\" value={searchedTxt} placeholder='Filter' onChange={setFilterBy} />\r\n      <ul>\r\n        {msgs.map((msg, idx) => (\r\n          <li key={idx}>\r\n            {/* <img src={`https://www.gravatar.com/avatar/${echo md5(strtolower( trim(msg.email)))}`} style={{width:'30px'}}/> */}\r\n            <img src={`https://www.gravatar.com/avatar/205e460b479e2e5b48aec07710c08d50`} style={{ width: '30px' }} />\r\n            {msg.email}: {msg.txt}\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </section>\r\n  )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}